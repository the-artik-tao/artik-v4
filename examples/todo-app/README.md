# Todo App - Mock Sandbox Demo

This is a **live demonstration** of `@the-artik-tao/mock-sandbox-core` in action!

## What This Demonstrates

This todo list application shows how the mock-sandbox library can:

1. **Automatically discover API calls** in your React code
2. **Generate realistic mock responses** using AI (Docker Model Runner)
3. **Run your app independently** from any backend

## The React App

A simple todo list with full CRUD operations:

- âœ… Fetch all todos (GET /api/todos)
- âœ… Create new todos (POST /api/todos)
- âœ… Toggle todo completion (PATCH /api/todos/:id)
- âœ… Delete todos (DELETE /api/todos/:id)

**No backend was written** - all API responses are AI-generated mocks!

## How It Works

### 1. API Discovery (Automatic)

The mock-sandbox tool scanned `src/App.tsx` and found these API calls:

```typescript
// Discovered automatically via AST parsing:
fetch("/api/todos")                          // GET
fetch("/api/todos", { method: "POST" })      // POST
fetch(`/api/todos/${id}`, { method: "PATCH" }) // PATCH
fetch(`/api/todos/${id}`, { method: "DELETE" }) // DELETE
```

### 2. Mock Synthesis (AI-Powered)

For each endpoint, DMR generated realistic responses:

**GET /api/todos**
```json
{
  "todos": [
    { "id": 1, "title": "Task 1", "completed": false },
    { "id": 2, "title": "Task 2", "completed": true }
  ]
}
```

**POST /api/todos**
```json
{
  "id": 123,
  "title": "Task 1",
  "completed": false,
  "created_at": "2023-01-01T00:00:00Z"
}
```

### 3. Mock Server Generation

An Express server was generated in `.sandbox/mock-server/` with:
- All 4 endpoints configured
- Latency simulation (100-300ms)
- CORS enabled
- Health check endpoint

## Running the Demo

### Option 1: Automatic (Recommended)

```bash
# Run the mock-sandbox tool
node run-with-mocks.mjs

# This will:
# 1. Discover your API calls
# 2. Synthesize mocks with AI
# 3. Generate a mock server
# 4. Show you how to run everything
```

### Option 2: Manual

```bash
# 1. Start the mock server
cd .sandbox/mock-server
npm install
npm start  # Runs on http://localhost:9001

# 2. Start the React app (in another terminal)
cd ../..
npm run dev  # Runs on http://localhost:5174
```

### Option 3: View Pre-Generated Mocks

```bash
# Check what mocks were generated
cat .sandbox/mock-server/mock-spec.json

# See the generated Express server
cat .sandbox/mock-server/index.js
```

## File Structure

```
todo-app/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ App.tsx              # React app with fetch() calls
â”‚   â””â”€â”€ App.css              # Styles
â”œâ”€â”€ .sandbox/                # Generated by mock-sandbox (gitignored)
â”‚   â”œâ”€â”€ mock-server/         # Express server with mocks
â”‚   â”‚   â”œâ”€â”€ index.js         # Server implementation
â”‚   â”‚   â”œâ”€â”€ package.json
â”‚   â”‚   â””â”€â”€ mock-spec.json   # All discovered APIs & mocks
â”‚   â””â”€â”€ overlay/
â”‚       â””â”€â”€ vite.config.sandbox.ts  # Proxy config
â”œâ”€â”€ run-with-mocks.mjs       # Demo script
â””â”€â”€ package.json
```

## Key Features Demonstrated

### âœ… Zero Backend Required

No backend code was written. The mock-sandbox tool:
- Found the API calls automatically
- Generated realistic responses
- Created a working server

### âœ… Realistic Data

The AI understands the context:
- GET endpoints â†’ arrays of resources
- POST endpoints â†’ created resource with id
- PATCH endpoints â†’ updated resource
- DELETE endpoints â†’ success confirmation

### âœ… Non-Invasive

The original project is **never modified**:
- All generated files are in `.sandbox/`
- Your `src/` code stays clean
- No manual mocking code needed

## Testing the APIs

```bash
# Health check
curl http://localhost:9001/health
# {"status":"ok","mocks":4}

# Get todos
curl http://localhost:9001/api/todos
# {"todos":[{"id":1,"title":"Task 1","completed":false},...]}

# Create todo
curl -X POST http://localhost:9001/api/todos \
  -H "Content-Type: application/json" \
  -d '{"title":"New Task","completed":false}'

# Update todo
curl -X PATCH http://localhost:9001/api/todos/1 \
  -H "Content-Type: application/json" \
  -d '{"completed":true}'

# Delete todo
curl -X DELETE http://localhost:9001/api/todos/1
```

## What Makes This Special

### Traditional Approach (Manual)
```typescript
// You would write:
const mockTodos = [/* hardcoded data */];

// Mock fetch manually
global.fetch = jest.fn(() => Promise.resolve({
  json: () => Promise.resolve(mockTodos)
}));

// Repeat for every endpoint...
```

### Mock-Sandbox Approach (Automatic)
```typescript
// You write NOTHING - just your real fetch() calls:
const response = await fetch("/api/todos");
const data = await response.json();

// Mock-sandbox discovers this automatically and creates:
// - Realistic mock data
// - Working Express server
// - Proper latency simulation
// - All endpoints configured
```

## Requirements

- Node.js â‰¥ 20.0.0
- Docker (optional, for AI-powered mocks via DMR)

## Try It Yourself

1. **Clone and run:**
   ```bash
   npm install
   node run-with-mocks.mjs
   ```

2. **Modify the API calls** in `src/App.tsx`

3. **Re-run the tool:**
   ```bash
   node run-with-mocks.mjs
   ```

4. **New mocks are generated automatically!**

## Real-World Use Cases

This demo shows how mock-sandbox can be used for:

- ðŸš€ **Frontend development** without waiting for backend
- ðŸ§ª **Testing** with realistic data
- ðŸ“± **Demos** and prototypes
- ðŸŽ“ **Learning** React without backend knowledge
- ðŸ”§ **Development** in offline environments

## Powered By

- **@the-artik-tao/mock-sandbox-core** - The library that makes this possible
- **Docker Model Runner (DMR)** - AI that generates realistic mocks
- **Babel Parser** - AST-based API discovery
- **Express** - Mock server runtime

---

**This entire todo app works without a backend** - that's the power of mock-sandbox! ðŸŽ‰
